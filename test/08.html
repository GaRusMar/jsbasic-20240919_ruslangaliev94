<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <title>Компоненты JavaScript</title>
</head>
<body>


<span class="loader"></span>


<!-- Вкладка Network в DevTools -->
<!-- Показывает все сетевые запросы, происходящие на странице. -->
<!-- Можно фильтровать запросы по типу (по умолчанию - "All"). -->

<!-- Headers (Заголовки) -->
<!-- Служебная информация, передаваемая на сервер и обратно. -->
<!-- Request Headers — информация, отправляемая браузером на сервер (язык, ОС и т.д.). -->
<!-- Response Headers — заголовки, приходящие от сервера (например, Content-Type: application/json). -->
<!-- General — базовая информация о запросе: адрес, метод (GET, POST и др.), статус, IP. -->

<!-- Payload -->
<!-- Здесь можно увидеть данные, которые отправляются на сервер с веб-страницы. -->
<!-- Query String Params — параметры, передаваемые в URL (разделяются знаком "="). -->
<!-- Payload отображается более наглядно, чем query string. -->

<!-- Preview и Response -->
<!-- Preview — данные, пришедшие с сервера, отображаются красиво. -->
<!-- Response — данные показываются так, как они пришли с сервера. -->

<!-- HTTP Статусы -->
<!-- Сервер всегда отвечает кодом состояния. -->
<!-- 200–300 — запрос успешно обработан. -->
<!-- Остальные статусы — можно поискать в Google для подробностей. -->

<!-- HTTP Методы -->
<!-- GET — для получения данных с сервера (можно передавать параметры). -->
<!-- POST — для отправки данных на сервер. -->

<!-- FormData -->
<!-- Специальный объект для хранения данных формы. -->
<!-- Данные не отображаются в URL, что делает POST более безопасным для авторизации. -->
<!-- GET передаёт данные в URL, что небезопасно для конфиденциальной информации. -->

<!-- Ajax (Asynchronous JavaScript and XML) -->
<!-- Позволяет загружать данные с сервера без перезагрузки страницы. -->
<!-- Используется в Single Page Applications (SPA). -->

<!-- Пример формы для практики с httpbin.org -->
<!-- При отправке GET-запроса на сервер -->
<form action="https://httpbin.org/get" id="getForm">
  <button type="submit">Загрузить IP address</button>
  <span id="ip"></span>
</form>


<!-- Работа с событием submit формы -->
<script>
  // Получаем элемент формы
  let getForm = document.querySelector('#getForm');
  let ipEl = document.querySelector('#ip');

  // Подписываемся на событие submit формы
  // Почему именно на submit, а не на кклик нопку например. Все просто. В форме могут быть и другие элементы, например input  итогда enter по input так же срабоатет submit
  getForm.addEventListener('submit', ev => {

    ev.preventDefault();//отменили submit формы


    //AJAX (аякс)
    //первым аргуентом передается адрес на который требуется выполнить запрос. Он выолпняется асихронно он отправил запрос и ждет ответ.
    //then - чтобы получить ответ вызывает этот метои а в него передаем функцию калюэк
    //в функцию будет пердан response от сервера но этоя еще не данные от сервера
    fetch('https://httpbin.org/get')
      .then((response) => {
        console.log('response:', response);
        // if (!response.ok) {
        //   alert('ошибка');
        // }
        console.log(response.headers.get('content-type')); //application/json
        //обязательно должны вернуть что то
        if (response.headers.get('content-type').includes('json')) {
          return response.json();
        } else {
          return response.text();
        }
        // получи данные
        //return response.json(); //если мы знаем что точно приходит json - можно json смело вызывать. Можно определить content-type Он распарсит строку как json и мы полуим готовый объект
        //return response.text(); // если тектс то не надо выхывать json будет ошибка текст не смодет распрариситься как json.
        //return response.blob(); //если бинарные данные картинки
      })
      .then(data => {
        console.log('data:', data);
        ipEl.textContent = data.origin;
      }); ///в качестве аргумента прнимиаеи данные котоыре нас интересуют второй then вызовет функцию тогда как все данные уже загруженны к нам в сервер


  });
</script>

<!--можем менять скокрось загрузки 4g или 3g-->

</body>
</html>
